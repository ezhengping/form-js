/** 
* ElementKit - v0.1.0.
* https://github.com/mkay581/element-kit.git
* Copyright 2014 Mark Kennedy. Licensed MIT.
*/

(function(){function e(e){var t,n;if(e)return e=e.trim(e),t=document.createElement("div"),t.innerHTML=e,n=t.childNodes[0],t.removeChild(n)}function t(e){var t=e,n,r;for(r=1;r<arguments.length;r++){n=arguments[r];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}var n=0,r={},i=function(e){this.el=e,this.classList=this._getClassList(),this._eventListenerMap=this._eventListenerMap||[],Object.defineProperty(this,"dataset",{get:function(){return this.getData()}.bind(this)})};i.prototype={appendOuterHtml:function(t){var n=this.el.parentNode,r=e(t);return n.replaceChild(r,this.el),r.appendChild(this.el),r},getUniqueId:function(){return this.el._kitId},getClosestAncestorElementByClassName:function(e){var t,n=this.el.parentNode;while(n&&typeof n.className=="string"){if(n.kit._hasClass(e)){t=n;break}n=n.parentNode}return t},addEventListener:function(e,t,n,r){var i=t;r=r||{},typeof i!="function"&&(i=this._createEventListener(n[t],n)),this.el.addEventListener(e,i,r.useCapture),this._eventListenerMap.push({event:e,listener:i,listenerId:t,context:n})},_createEventListener:function(e,t){return function(n){t=t||this,e.apply(t,arguments)}},removeEventListener:function(e,t,n){var r=this._eventListenerMap||[],i,s;if(r.length)for(i=0;i<r.length;i++){s=r[i];if(s&&s.event===e&&s.listenerId===t&&s.context===n){this.el.removeEventListener(e,s.listener),this._eventListenerMap[i]=null;break}}},waitForTransition:function(e){var t=this.getTransitionDuration();e&&(t>0?setTimeout(e.bind(this,this.el),t):e(this.el))},getTransitionDuration:function(){var e=this.getCssComputedProperty("transition-delay")||"0ms",t=this.getCssComputedProperty("transition-duration")||"0ms";return e=this._convertCssTimeValueToMilliseconds(e),t=this._convertCssTimeValueToMilliseconds(t),e+t},getCssComputedProperty:function(e){var t=window.getComputedStyle(this.el);return t.getPropertyValue(e)||this.el.style[this._getJsPropName(e)]},_convertCssTimeValueToMilliseconds:function(e){var t=this._convertCssUnitToNumber(e),n=e.replace(t,"");return n==="s"?e=t*1e3:e=t,e},_convertCssUnitToNumber:function(e){return Number(e.replace(/[a-z]+/,""))},_getClassList:function(){return this.el.classList?this.el.classList:{add:this._addClass.bind(this),remove:this._removeClass.bind(this),contains:this._hasClass.bind(this),toggle:this._toggleClass.bind(this)}},_getCssClasses:function(){return this.el.className.split(" ")},_toggleClass:function(e){this._hasClass(e)?this._removeClass(e):this._addClass(e)},_addClass:function(e){if(!this._hasClass(e)){var t=this.el.className;t&&(this.el.className=t+" "),this.el.className=this.el.className+e}},_removeClass:function(e){var t;this._hasClass(e)&&(this.el.className===e?this.el.className="":(t="[\\s]*"+e,t=new RegExp(t,"i"),this.el.className=this.el.className.replace(t,"")))},_hasClass:function(e){var t=this._getCssClasses();return t.indexOf(e)!==-1},_getJsPropName:function(e){return e=e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()}),e},getAttributes:function(){var e=this.el.attributes,t={};if(e.length)for(var n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},_getDomData:function(){var e=this.getAttributes(),t={},n,r;for(n in e)e.hasOwnProperty(n)&&(r=e[n],n.indexOf("data-")===0&&(n=n.substr(5),t[n]=r));return t},getData:function(){var e;this._data=t({},this._data,this._getDomData());for(e in this._data)if(this._data.hasOwnProperty(e)){var n=this._data[e];Object.defineProperty(this._data,e,{writeable:!0,get:function(){return n}.bind(this),set:function(t){this.setData.bind(this,e,t)}.bind(this)})}return this._data},setData:function(e,t){this.el.setAttribute("data-"+e,t),this._data[e]=t}},Object.defineProperty(Element.prototype,"kit",{get:function(){return r[this._kitId]||(n++,this._kitId=n,r[this._kitId]=new i(this)),r[this._kitId]}})})();