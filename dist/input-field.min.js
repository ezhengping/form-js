/** 
* FormJS - v0.1.2.
* https://github.com/mkay581/formjs.git
* Copyright 2014. Licensed MIT.
*/
define(["underscore","./form-element","element-kit"],function(a,b){function c(){if("Microsoft Internet Explorer"!=navigator.appName)return!1;var a=navigator.userAgent,b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");return null!=b.exec(a)?parseInt(RegExp.$1):void 0}var d=function(a){this.initialize(a)};return d.prototype=a.extend({},b.prototype,{initialize:function(c){this.options=a.extend({el:null,onChange:null,onKeyDownChange:null,containerClass:"ui-input-text",inputClass:"ui-input-text-input",disabledClass:"ui-input-text-disabled",activeClass:"ui-input-text-active",placeholderClass:"ui-input-text-placeholder"},c),b.prototype.initialize.call(this,this.options),this.setup()},setup:function(){var a=this.options.el;a.kit.classList.add(this.options.inputClass),this._container=this._buildUIElement(a),this._inputEl=this._container.getElementsByClassName(this.options.inputClass)[0],this.origInputValue=a.value,this.isInitDisabled=a.disabled,this.isInitDisabled&&this._container.kit.classList.add(this.options.disabledClass),this._bindEvents(),this.origInputValue||this.showPlaceholder()},_bindEvents:function(){var a=this.getFormElement();a.kit.addEventListener("focus","_onInputFocus",this),a.kit.addEventListener("blur","_onInputBlur",this),a.kit.addEventListener("change","_onInputValueChange",this),a.kit.addEventListener("keydown","_onInputKeyDown",this)},_unbindEvents:function(){var a=this.getFormElement();a.kit.removeEventListener("focus","_onInputFocus",this),a.kit.removeEventListener("blur","_onInputBlur",this),a.kit.removeEventListener("change","_onInputValueChange",this),a.kit.removeEventListener("keydown","_onInputKeyDown",this)},_onInputKeyDown:function(a){this.keyDownTimeoutId&&clearTimeout(this.keyDownTimeoutId),this.keyDownTimeoutId=setTimeout(this._triggerKeyDownChange.bind(this,a),1)},_triggerKeyDownChange:function(a){this.options.onKeyDownChange&&this.options.onKeyDownChange(this.getValue(),this.getFormElement(),this.getUIElement(),a)},isPlaceholderSupported:function(){var a=c();return!a||8!==a&&9!==a},showPlaceholder:function(){this.isPlaceholderSupported()||(this.getFormElement().value=this.getPlaceholder(),this.getUIElement().kit.classList.add(this.options.placeholderClass))},setValue:function(a){var b=this.getFormElement(),c=b.value;a!==c&&a!==this.getPlaceholder()&&(this.getFormElement().value=a,this._triggerChange())},getValue:function(){return this.getFormElement().value},clearPlaceholder:function(){this.isPlaceholderSupported()||(this.getFormElement().value="",this.getUIElement().kit.classList.remove(this.options.placeholderClass))},_buildUIElement:function(a){return a.kit.appendOuterHtml('<div class="'+this.options.containerClass+'"></div>')},getPlaceholder:function(){var a=this.getFormElement().getAttribute("placeholder");return null===a&&(a=""),a},_onInputFocus:function(){this.getValue()===this.getPlaceholder()&&this.clearPlaceholder(),this.getUIElement().kit.classList.add(this.options.activeClass)},_onInputBlur:function(){this.getValue()||this.showPlaceholder(),this.getUIElement().kit.classList.remove(this.options.activeClass)},_triggerChange:function(a){var b=[this.getValue(),this.getFormElement(),this.getUIElement()];a&&b.push(a),this.options.onChange&&this.options.onChange.apply(this,b)},_onInputValueChange:function(a){this._triggerChange(a)},getFormElement:function(){return this._inputEl},getUIElement:function(){return this._container},enable:function(){this.getFormElement().removeAttribute("disabled"),this.getUIElement().kit.classList.remove(this.options.disabledClass)},disable:function(){this.getFormElement().setAttribute("disabled","true"),this.getUIElement().kit.classList.add(this.options.disabledClass)},getElementKey:function(){return"inputText"},destroy:function(){var a=this.getUIElement(),c=this.getFormElement();this._unbindEvents(),a.parentNode.replaceChild(c,a),this.isInitDisabled&&c.setAttribute("disabled","true"),this.setValue(this.origInputValue),b.prototype.destroy.call(this)}}),d});